# 查看 Docker PostgreSQL 数据库中的数据

## 方法一：使用 PostgreSQL 命令行（推荐）

### 1. 进入 PostgreSQL 容器命令行

```bash
docker exec -it tradespro_postgres psql -U tradespro_user -d tradespro
```

### 2. 查看所有表

```sql
\dt
```

### 3. 查看用户信息

```sql
-- 查看所有用户
SELECT id, email, full_name, company, license_number, is_active, is_verified, created_at 
FROM users 
ORDER BY created_at DESC;

-- 查看用户详细信息
SELECT * FROM users;
```

### 4. 查看项目信息

```sql
-- 查看所有项目
SELECT id, owner_id, name, description, location, client_name, is_archived, created_at, updated_at 
FROM projects 
ORDER BY created_at DESC;

-- 查看项目和创建者的关联信息
SELECT 
    p.id as project_id,
    p.name as project_name,
    p.description,
    p.location,
    p.client_name,
    u.email as owner_email,
    u.full_name as owner_name,
    p.created_at,
    p.updated_at
FROM projects p
LEFT JOIN users u ON p.owner_id = u.id
ORDER BY p.created_at DESC;
```

### 5. 查看计算记录

```sql
-- 查看所有计算记录
SELECT 
    c.id as calc_id,
    p.name as project_name,
    c.inputs,
    c.result_bundle,
    c.is_signed,
    c.signed_at,
    c.created_at
FROM calculations c
LEFT JOIN projects p ON c.project_id = p.id
ORDER BY c.created_at DESC
LIMIT 10;
```

### 6. 退出 PostgreSQL 命令行

```sql
\q
```

## 方法二：使用一行命令查询（不进入交互模式）

### 查看所有用户

```bash
docker exec -it tradespro_postgres psql -U tradespro_user -d tradespro -c "SELECT id, email, full_name, company, created_at FROM users ORDER BY created_at DESC;"
```

### 查看所有项目

```bash
docker exec -it tradespro_postgres psql -U tradespro_user -d tradespro -c "SELECT id, owner_id, name, description, location, client_name, created_at FROM projects ORDER BY created_at DESC;"
```

### 查看项目和用户关联

```bash
docker exec -it tradespro_postgres psql -U tradespro_user -d tradespro -c "SELECT p.id, p.name as project_name, u.email as owner_email, u.full_name as owner_name, p.created_at FROM projects p LEFT JOIN users u ON p.owner_id = u.id ORDER BY p.created_at DESC;"
```

## 方法三：使用数据库客户端工具

### 连接信息

- **主机**: `localhost` (Windows/Mac) 或 Docker 容器 IP
- **端口**: `5432`
- **数据库**: `tradespro`
- **用户名**: `tradespro_user`
- **密码**: `changeme`

### 推荐的客户端工具

1. **pgAdmin** - PostgreSQL 官方图形界面工具
2. **DBeaver** - 免费的多数据库客户端
3. **TablePlus** - 现代化的数据库客户端
4. **VS Code 扩展**: PostgreSQL (by Chris Kolkman)

## 快速查询示例

### 查看最新创建的项目

```sql
SELECT * FROM projects ORDER BY created_at DESC LIMIT 5;
```

### 查看用户及其项目数量

```sql
SELECT 
    u.id,
    u.email,
    u.full_name,
    COUNT(p.id) as project_count
FROM users u
LEFT JOIN projects p ON u.id = p.owner_id
GROUP BY u.id, u.email, u.full_name
ORDER BY project_count DESC;
```

### 查看项目的计算数量

```sql
SELECT 
    p.id,
    p.name,
    COUNT(c.id) as calculation_count
FROM projects p
LEFT JOIN calculations c ON p.id = c.project_id
GROUP BY p.id, p.name
ORDER BY calculation_count DESC;
```

## 常见命令

```sql
-- 查看数据库版本
SELECT version();

-- 查看所有数据库
\l

-- 查看当前数据库的表
\dt

-- 查看表结构
\d users
\d projects

-- 查看表的详细信息
\d+ users

-- 查看所有表的大小
SELECT 
    schemaname,
    tablename,
    pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size
FROM pg_tables
WHERE schemaname = 'public'
ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;
```

## 注意事项

1. **容器名称**: 确保容器名称是 `tradespro_postgres`，如果不是，请先检查：
   ```bash
   docker ps | findstr postgres
   ```

2. **容器未运行**: 如果容器未运行，先启动：
   ```bash
   docker start tradespro_postgres
   ```

3. **Windows PowerShell**: 如果使用 PowerShell，可能需要调整命令格式。








